"use strict";var O=Object.create;var h=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,x=Object.prototype.hasOwnProperty;var I=(o,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of w(e))!x.call(o,s)&&s!==t&&h(o,s,{get:()=>e[s],enumerable:!(r=v(e,s))||r.enumerable});return o};var E=(o,e,t)=>(t=o!=null?O(j(o)):{},I(e||!o||!o.__esModule?h(t,"default",{value:o,enumerable:!0}):t,o));var S=E(require("@hapi/hapi"));var B=require("nanoid");var l=require("fs");var n="src/books.json";var i=()=>(0,l.readFileSync)(n,"utf-8");var b=require("fs");var f=o=>{(0,b.writeFileSync)(n,JSON.stringify(o))};var g=async(o,e)=>{let{name:t,year:r,author:s,summary:p,publisher:d,pageCount:a,readPage:m,reading:T}=o.payload;if(t===void 0)return e.response({status:"fail",message:"Gagal menambahkan buku. Mohon isi nama buku"}).code(400);if(m>a)return e.response({status:"fail",message:"Gagal menambahkan buku. readPage tidak boleh lebih besar dari pageCount"}).code(400);let k=(0,B.nanoid)(16),u=new Date().toISOString(),c={bookId:k,name:t,year:r,author:s,summary:p,publisher:d,pageCount:a,readPage:m,finished:!1,reading:T,insertedAt:u,updatedAt:u};console.log(c);let D=i(),P=JSON.parse(D).concat([c]);return f(P),e.response({status:"success",message:"Buku berhasil ditambahkan",data:{bookId:k}}).code(201)};var R=async(o,e)=>{let r=JSON.parse(i()).map(s=>{let{bookId:p,name:d,publisher:a}=s;return{id:p,name:d,publisher:a}});return e.response({status:"success",data:{books:r}}).code(200)};var y=[{method:"POST",path:"/books",handler:g},{method:"GET",path:"/books",handler:R},{method:"GET",path:"/books/{bookId}",handler:(o,e)=>"Book Library Returned."},{method:"PUT",path:"/books/{bookId}",handler:(o,e)=>"Book Data Modified."},{method:"DELETE",path:"/books/{bookId}",handler:(o,e)=>"Book Deleted."}];var q=require("fs"),G=async()=>{let o=S.default.server({port:9e3,host:"localhost"});o.route(y),(0,q.writeFileSync)("src/books.json","[]"),await o.start(),console.log(`Server berjalan pada ${o.info.uri}`)};G();
