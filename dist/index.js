"use strict";var j=Object.create;var c=Object.defineProperty;var v=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var P=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var x=(o,e,s,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let t of I(e))!w.call(o,t)&&t!==s&&c(o,t,{get:()=>e[t],enumerable:!(a=v(e,t))||a.enumerable});return o};var E=(o,e,s)=>(s=o!=null?j(P(o)):{},x(e||!o||!o.__esModule?c(s,"default",{value:o,enumerable:!0}):s,o));var S=E(require("@hapi/hapi"));var f=require("nanoid");var n=require("fs"),l="src/books.json",b=()=>{(0,n.writeFileSync)("src/books.json","[]")},r=()=>(0,n.readFileSync)(l,"utf-8"),h=o=>{(0,n.writeFileSync)(l,JSON.stringify(o))};var B=async(o,e)=>{let{name:s,year:a,author:t,summary:i,publisher:d,pageCount:p,readPage:k,reading:q}=o.payload;if(s===void 0)return e.response({status:"fail",message:"Gagal menambahkan buku. Mohon isi nama buku"}).code(400);if(k>p)return e.response({status:"fail",message:"Gagal menambahkan buku. readPage tidak boleh lebih besar dari pageCount"}).code(400);let m=(0,f.nanoid)(16),u=new Date().toISOString(),D={bookId:m,name:s,year:a,author:t,summary:i,publisher:d,pageCount:p,readPage:k,finished:!1,reading:q,insertedAt:u,updatedAt:u},O=r(),T=JSON.parse(O).concat([D]);return h(T),e.response({status:"success",message:"Buku berhasil ditambahkan",data:{bookId:m}}).code(201)};var g=async(o,e)=>{let a=JSON.parse(r()).map(t=>{let{bookId:i,name:d,publisher:p}=t;return{id:i,name:d,publisher:p}});return e.response({status:"success",data:{books:a}}).code(200)};var R=async(o,e)=>{let{bookId:s}=o.params,a=JSON.parse(r());for(let t=0;t<a.length;t++)if(console.log(s===a[t].bookId),a[t].bookId===s)return e.response({status:"success",data:{book:a[t]}}).code(200);return e.response({status:"fail",message:"Buku tidak ditemukan"}).code(404)};var y=[{method:"POST",path:"/books",handler:B},{method:"GET",path:"/books",handler:g},{method:"GET",path:"/books/{bookId}",handler:R},{method:"PUT",path:"/books/{bookId}",handler:(o,e)=>"Book Data Modified."},{method:"DELETE",path:"/books/{bookId}",handler:(o,e)=>"Book Deleted."}];var G=async()=>{let o=S.default.server({port:9e3,host:"localhost"});o.route(y),b(),await o.start(),console.log(`Server berjalan pada ${o.info.uri}`)};G();
